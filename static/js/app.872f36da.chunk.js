(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{239:function(e,t,a){"use strict";a.d(t,"a",(function(){return fe}));var n=a(0),r=a.n(n),o=a(52),i=a(36),c=a(432),s=a(3),l=a.n(s),u=a(16),m=a.n(u),p=a(4),d=a(46),g=a(40),h=a(138),f=a(134),v=a(5),E=v.a.create({container:{position:"absolute",bottom:0,zIndex:1e3,flexDirection:"row",justifyContent:"space-around",alignItems:"center",width:"100%",height:80,backgroundColor:"#1f2125",paddingBottom:15}}),b=function(e){return r.a.createElement(p.a,{style:E.container},r.a.createElement(g.a,{onPress:function(){return e.navigate("Feed")}},r.a.createElement(h.a,{name:"newspaper",color:"white",size:30})),r.a.createElement(g.a,{onPress:function(){return e.navigate("Search")}},r.a.createElement(f.a,{name:"md-search",color:"white",size:30})),r.a.createElement(g.a,{onPress:function(){return e.navigate("PostForm")}},r.a.createElement(h.a,{name:"plus-circle",color:"white",size:30})),r.a.createElement(g.a,{onPress:function(){return e.navigate("Account")}},r.a.createElement(h.a,{name:"settings",color:"white",size:30})))},w=v.a.create({container:{height:"100%",backgroundColor:"#33363a"},containerWithBottomTabBar:{marginBottom:80}}),y=function(e){return r.a.createElement(p.a,{style:w.container},e.children,r.a.createElement(b,{navigate:e.navigate}))},x=a(229),j=a.n(x).a.create({baseURL:"https://reactnative.devcamp.space/memipedia/"}),O=a(38),k=a(89),S=a(233),C=a(34),A=a(32),_=a(240),P=a(170),I=v.a.create({itemWrapper:{marginBottom:20},imageWrapper:{marginBottom:15},contentWrapper:{paddingLeft:15,paddingRight:15},contentText:{color:"white",fontSize:Object(P.a)(14,680)},postHeading:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},nameText:{color:"white",fontSize:Object(P.a)(20,680),fontWeight:"900"}}),T=function(e){var t=e.post,a=t.name,n=t.post_image_url;return r.a.createElement(p.a,{style:I.itemWrapper},r.a.createElement(p.a,{style:I.imageWrapper},r.a.createElement(_.a,{width:A.a.get("window").width,source:{uri:n}})),r.a.createElement(p.a,{style:[I.contentWrapper,I.postHeading]},r.a.createElement(C.a,{style:I.nameText},a)))},L=function(e){return r.a.createElement(O.a,{refreshControl:r.a.createElement(k.a,{refreshing:e.isLoading,onRefresh:function(){e.getPosts&&e.getPosts()},tintColor:"white",colors:["white"]}),style:w.containerWithBottomTabBar},e.isLoading&&0===e.posts.length?r.a.createElement(S.a,{color:"white",size:"large"}):e.posts.length>0?e.posts.map((function(t){return r.a.createElement(g.a,{key:t.id,onPress:function(){return function(t){e.navigate("PostDetail",{post:t})}(t)}},r.a.createElement(T,{post:t}))})):null)},R=a(27),W=v.a.create({searchFormContainer:{padding:15,flexDirection:"row"},searchTextInput:{backgroundColor:"white",width:"85%",borderRadius:25,fontWeight:"500",paddingLeft:21},searchIcon:{justifyContent:"center",alignItems:"center",width:"15%"}}),B=W.searchFormContainer,z=W.searchTextInput,F=W.searchIcon,N=Object(n.createContext)(null),G=a(15),D=a.n(G),U=function(e){return r.a.createElement(g.a,D()({style:{backgroundColor:e.disabled?"#EAEAEA":"#eb523c",height:40,justifyContent:"center",alignItems:"center",borderRadius:3}},e),r.a.createElement(C.a,{style:{color:e.disabled?"#eb523c":"white",fontSize:20,fontWeight:"700"}},e.text))},q=a(43),H=a(242),J=a(63),K=a(82),M=a(75),Q=a(243),V=Object(n.forwardRef)((function(e,t){var a=Object(n.useState)(null),r=m()(a,2),o=r[0],i=r[1];Object(n.useImperativeHandle)(t,(function(){return{clearImage:function(){i(null)}}})),Object(n.useEffect)((function(){c()}),[]);var c=function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!K.a.platform.ios){t.next=6;break}return t.next=3,l.a.awrap(M.c(M.b));case 3:e=t.sent,"granted"!==e.status&&alert("Sorry, we need camera roll permissions to make this work!");case 6:case"end":return t.stop()}}),null,null,null,Promise)},s={height:100,width:100};return n.createElement(g.a,{onPress:function(){var t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l.a.awrap(H.a({mediaTypes:J.a.All,allowsEditing:!0,aspect:[4,3],quality:1}));case 3:(t=a.sent).cancelled||(i(t.uri),e.setPostImage(t.uri)),console.log(t),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}}),null,null,[[0,8]],Promise)},style:[s,{justifyContent:"center",alignItems:"center"}]},o?n.createElement(q.a,{source:{uri:o},style:s}):n.createElement(Q.a,{name:"camera",color:"#33363a",size:42}))})),X=v.a.create({container:{height:"100%"},formGrid:{flexDirection:"row",marginBottom:20},textInputWrapper:{width:"100%"},inputElement:{borderBottomColor:"#EAEAEA",borderBottomWidth:1,borderLeftColor:"#EAEAEA",borderLeftWidth:1,padding:3},textAreaElement:{height:76},buttonWrapper:{paddingRight:15,paddingLeft:15}}),Y=X.container,Z=X.formGrid,$=X.textInputWrapper,ee=X.inputElement,te=X.textAreaElement,ae=X.buttonWrapper,ne=v.a.create({textFieldWrapper:{marginTop:20,marginBottom:20},textField:{backgroundColor:"white",borderRadius:20,height:40,paddingLeft:20}}),re=v.a.create({container:{backgroundColor:"#1f2125",padding:15,height:"100%",paddingTop:K.a.statusBarHeight}}),oe=ne.textFieldWrapper,ie=ne.textField,ce=a(385),se=function(){return r.a.createElement(q.a,{source:ce,style:{height:30,width:29}})},le=I.contentWrapper,ue=I.contentText,me=Object(c.a)({Feed:function(e){var t=Object(n.useState)([]),a=m()(t,2),o=a[0],i=a[1],c=Object(n.useState)(!0),s=m()(c,2),u=s[0],g=s[1];Object(n.useEffect)((function(){h()}),[]);var h=function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(d.b("memipedia_secure_token"));case 2:e=t.sent,g(!0),j.get("memipedia_posts",{headers:{Authorization:"Bearer "+e}}).then((function(e){i(e.data.memipedia_posts),g(!1)})).catch((function(e){console.log("error from posts",e),g(!1)}));case 5:case"end":return t.stop()}}),null,null,null,Promise)};return r.a.createElement(y,{navigate:e.navigation.navigate},r.a.createElement(p.a,null,r.a.createElement(L,{isLoading:u,getPosts:h,posts:o,navigate:e.navigation.navigate})))},Search:function(e){var t=Object(n.useState)(""),a=m()(t,2),o=a[0],i=a[1],c=Object(n.useState)([]),s=m()(c,2),u=s[0],h=s[1],v=Object(n.useState)(!1),E=m()(v,2),b=E[0],w=E[1],x=Object(n.useState)(!1),O=m()(x,2),k=O[0],S=O[1],A=function(){var e,t,a;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(d.b("memipedia_secure_token"));case 2:e=n.sent,w(!0),S(!1),t={query:o},a={Authorization:"Bearer "+e},j.get("memipedia_queries",{params:t,headers:a}).then((function(e){0===e.data.memipedia_posts.length&&S(!0),h(e.data.memipedia_posts),w(!1)})).catch((function(e){w(!1),alert("Error running query")}));case 8:case"end":return n.stop()}}),null,null,null,Promise)},_=r.a.createElement(p.a,{style:B},r.a.createElement(R.a,{value:o,onChangeText:function(e){return i(e)},placeholder:"Search for a meme",onSubmitEditing:A,style:z}),r.a.createElement(g.a,{style:F,onPress:A},r.a.createElement(f.a,{name:"md-search",color:"white",size:30})));return r.a.createElement(y,{navigate:e.navigation.navigate},_,k?r.a.createElement(p.a,{style:{paddingRight:15,paddingLeft:15}},r.a.createElement(C.a,{style:{color:"white"}},"There were no posts matching your search")):u&&u.length>0?r.a.createElement(L,{getPosts:A,isLoading:b,posts:u,navigate:e.navigation.navigate}):null)},Account:function(e){var t=Object(n.useContext)(N).setCurrentUser;return r.a.createElement(p.a,{style:{padding:15}},r.a.createElement(U,{onPress:function(){return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.awrap(d.a("memipedia_secure_token"));case 2:t(null),e.navigation.navigate("Auth");case 4:case"end":return a.stop()}}),null,null,null,Promise)},text:"Sign Out"}))},PostForm:function(e){var t=Object(n.useRef)(),a=Object(n.useState)(""),o=m()(a,2),i=o[0],c=o[1],s=Object(n.useState)(""),u=m()(s,2),g=u[0],h=u[1],f=Object(n.useState)(null),v=m()(f,2),E=v[0],b=v[1],w=Object(n.useState)(!1),y=m()(w,2),x=y[0],k=y[1],S=function(){var e=new FormData;e.append("post[name]",i),e.append("post[content]",g);var t=E.split("."),a=t[t.length-1];return e.append("post[post_image]",{uri:E,name:"photo."+a,type:"image/"+a}),e};return r.a.createElement(O.a,{style:Y},r.a.createElement(p.a,{style:Z},r.a.createElement(V,{ref:t,setPostImage:b}),r.a.createElement(p.a,{style:$},r.a.createElement(R.a,{placeholder:"Name",value:i,onChangeText:function(e){return c(e)},style:ee}),r.a.createElement(R.a,{placeholder:"Add meme explanation here",value:g,onChangeText:function(e){return h(e)},style:[ee,te],multiline:!0}))),r.a.createElement(p.a,{style:ae},x?r.a.createElement(U,{text:"Submitting...",disabled:!0}):r.a.createElement(U,{text:"Submit",onPress:function(){var a;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(d.b("memipedia_secure_token"));case 2:a=n.sent,k(!0),j.post("memipedia_posts",S(),{headers:{Authorization:"Bearer "+a,Accept:"application/json","Content-Type":"multipart/form-data"}}).then((function(a){a.data.memipedia_post?(t.current.clearImage(),c(""),h(""),b(null),k(!1),e.navigation.navigate("PostDetail",{post:a.data.memipedia_post})):(k(!1),alert("There was an issue creating the post, all fields are required, and only images are allowed."))})).catch((function(e){console.log("error from creating new post",e),k(!1)}));case 5:case"end":return n.stop()}}),null,null,null,Promise)}})))},PostDetail:{screen:function(e){var t=e.navigation.state.params.post;return r.a.createElement(y,{navigate:e.navigation.navigate},r.a.createElement(O.a,null,r.a.createElement(T,{post:t}),r.a.createElement(p.a,{style:le},r.a.createElement(C.a,{style:ue},t.content))))},navigationOptions:{headerLeft:function(){return null}}}},{initialRouteName:"Feed",defaultNavigationOptions:{headerStyle:{backgroundColor:"#1f2125"},headerTintColor:"#fff",headerTitle:function(){return r.a.createElement(se,null)}}}),pe=Object(c.a)({Auth:function(e){var t=Object(n.useState)("LOGIN"),a=m()(t,2),o=a[0],i=a[1],c=Object(n.useState)(""),s=m()(c,2),u=s[0],h=s[1],f=Object(n.useState)(""),v=m()(f,2),E=v[0],b=v[1],w=Object(n.useState)(!1),y=m()(w,2),x=y[0],k=y[1],S=Object(n.useContext)(N).getUser,A=function(){var t={auth:{email:u,password:E}};j.post("memipedia_user_token",t).then((function(t){return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.data.jwt){a.next=8;break}return a.next=3,l.a.awrap(d.c("memipedia_secure_token",t.data.jwt));case 3:S(),k(!1),e.navigation.navigate("Feed"),a.next=10;break;case 8:k(!1),alert("It looks like you typed in the wrong email or password, please try again");case 10:case"end":return a.stop()}}),null,null,null,Promise)})).catch((function(e){k(!1),alert("It looks like you typed in the wrong email or password, please try again")}))},_=function(){var e={user:{email:u,password:E}};j.post("memipedia_users",e).then((function(e){var t;console.log("Res for creating user",e.data),e.data.memipedia_user?A():(k(!1),alert("Error creating account: "+(t=e.data.errors,Object.keys(t).map((function(e){return{key:e,value:t[e]}})).map((function(e){return e.key+": "+e.value.join(", ")})).join(", "))))})).catch((function(e){k(!1),alert("Error creating user account")}))},P=function(){k(!0),"LOGIN"===o?A():_()};return r.a.createElement(O.a,{style:re.container},r.a.createElement(p.a,{style:oe},r.a.createElement(R.a,{placeholder:"Email",value:u,onChangeText:function(e){return h(e)},style:ie,autoCapitalize:"none",spellCheck:!1})),r.a.createElement(p.a,{style:oe},r.a.createElement(R.a,{placeholder:"Password",value:E,onChangeText:function(e){return b(e)},style:ie,secureTextEntry:!0,onSubmitEditing:P})),r.a.createElement(g.a,{style:{marginTop:10,marginBottom:20},onPress:function(){"LOGIN"===o?i("REGISTER"):"REGISTER"===o&&i("LOGIN")}},r.a.createElement(C.a,{style:{color:"white"}},"LOGIN"===o?"Need an account? Register":"REGISTER"===o?"Already have an account? Login":void 0)),x?r.a.createElement(U,{text:"Submitting...",disabled:!0}):r.a.createElement(U,{text:"LOGIN"===o?"Login":"REGISTER"===o?"Register":void 0,onPress:P}))}},{initialRouteName:"Auth",defaultNavigationOptions:{headerShown:!1}}),de=Object(i.createAppContainer)(Object(i.createSwitchNavigator)({AuthLoading:function(e){var t=Object(n.useContext)(N).setCurrentUser;Object(n.useEffect)((function(){a()}),[]);var a=function(){var a;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(d.b("memipedia_secure_token"));case 2:a=n.sent,console.log("In check login in the auth loading screen"),a?j.get("logged_in",{headers:{Authorization:"Bearer "+a}}).then((function(a){console.log("response form checklogin",a.data),a.data.memipedia_user?(t(a.data.memipedia_user),e.navigation.navigate("App")):(t(null),e.navigation.navigate("Auth"))})).catch((function(a){t(null),e.navigation.navigate("Auth")})):(t(null),e.navigation.navigate("Auth"));case 5:case"end":return n.stop()}}),null,null,null,Promise)};return r.a.createElement(p.a,null)},App:me,Auth:pe},{initialRouteName:"AuthLoading"})),ge=function(e){var t=Object(n.useState)({id:123,email:"hey@you.com"}),a=m()(t,2),o=a[0],i=a[1],c={currentUser:o,setCurrentUser:i,getUser:function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(d.b("memipedia_secure_token"));case 2:e=t.sent,j.get("logged_in",{headers:{Authorization:"Bearer "+e}}).then((function(e){console.log("response from getUser",e.data),e.data.memipedia_user?i(e.data.memipedia_user):i(null)})).catch((function(e){i(null)}));case 4:case"end":return t.stop()}}),null,null,null,Promise)}};return r.a.createElement(N.Provider,{value:c},e.children)},he=Object(i.createAppContainer)(de);function fe(){return r.a.createElement(ge,null,r.a.createElement(o.a,{barStyle:"light-content"}),r.a.createElement(he,null))}},244:function(e,t,a){a(245),e.exports=a(414)},245:function(e,t){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/maria72865/md-react-native-memipedia.git/expo-service-worker.js",{scope:"/maria72865/md-react-native-memipedia.git/"}).then((function(e){})).catch((function(e){console.info("Failed to register service-worker",e)}))}))},385:function(e,t,a){e.exports=a.p+"static/media/memipedia-logo.8791171f.png"}},[[244,1,2]]]);
//# sourceMappingURL=app.872f36da.chunk.js.map